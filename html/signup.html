<html>
<head>
    <link rel="stylesheet" type="text/css" href="../css/signup.css">
    <link rel="stylesheet" href="../css/loginTitle.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>Sign Up</title>

    <script language="javascript">

        function dataValidation(){
            if(document.userSignUp.userName.value=='') {
                alert("Please enter your Email Address");
                return false;
            }
            if(document.userSignUp.name.value=='') {
                alert("Please enter your Full Name");
                return false;
            }
            if(document.userSignUp.password.value=='') {
                alert("Please enter your Password");
                return false;
            }
            if (document.userSignUp.password.value.length<8){
                alert("Password should be at least 8 characters");
                return false;
            }
            if(document.userSignUp.cpw.value=='') {
                alert("Please enter Confirm Password");
                return false;
            }
            if(document.userSignUp.password.value!=document.userSignUp.cpw.value) {
                alert("Password and Confirmation does not match");
                return false;
            }
            else{
                // alert("IF");
                loadDoc();
                // test();
                return confirm;
            }
        }

    </script>

</head>
<body>
    <div class="h1">National Covid Management System</div>
    <div class="ul">
        <div class="li"><a href="index.php">Home</a></div>
        <div class="li" style="float:right"><a href="login.html">LOGIN</a></div>

        <div class="li"><a href="help.php">Help</a></div>

    </div>

    <div class="signBox">
        <form action="" name="userSignUp" onsubmit="return dataValidation()" method="POST">
            <h1>Sign Up</h1>
            <table>
                <tr>
                    <td width="50%">User Type</td>
                    <td>
                        <select name = "userType" id="userType" style="color: gray">
                            <option selected value="user">User</option>
                            <option value="moh">MOH</option>
                            <option value="hospital">Hospital</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Username</td>
                    <td><input type="email" name="userName" placeholder="Enter You Email" required></td>
                </tr>
                <tr>
                    <td>Full Name</td>
                    <td><input type="text" name="name" placeholder="Your Full Name" required></td>
                </tr>
                <tr>
                    <td>Password</td>
                    <td><input type="password" name="password" placeholder="Password" required></td>
                </tr>
                <tr>
                    <td>Confirm Password</td>
                    <td><input type="password" name="cpw" placeholder="Re-Enter Password" required></td>
                </tr>
            </table><br>
            <div style="text-align: center;"><input type="submit" name="submit" value="Sign Up"></div>
        </form>
        <p style="font-weight: normal; text-align: center">Already have account?
            <a href="login.html">&nbsp; Login</a>
        </p>
    </div>
<!--    <br>-->
<!--    <p></p>-->
<!--    <br>-->
    <script type="text/javascript">
        // function test(){
        //     alert("Test");
        //     $(document).ready(function () {
        //         $('#userSignUp').submit(function (e) {
        //             e.preventDefault();
        //             let form = $(this);
        //             loadDoc(form)
        //         });
        //     });
        // }

        function loadDoc(){
            // alert("LoadDoc");
            var userName = document.userSignUp.userName.value;
            var password = document.userSignUp.password.value;
            var name = document.userSignUp.name.value;
            var userType = $("#userType").val();
            if(userType == "user"){
                var moh = 0;
                var hospital = 0;

            }else if (userType == "moh"){
                var moh = 1;
                var hospital = 0;
            }else {
                var moh = 0;
                var hospital = 1;
            }
            var URL = 'http://localhost:8080//user?type=signup&userName='+userName+'&password='+password+'&name='+name+'&moh='+moh+'&hospital='+hospital;
            $.post(URL,
                function (json, textStatus, jqXHR) {
                    alert(json);
                    alert("Reg Ok");
            }).fail(function (jqXHR, textStatus, errorThrown){
                alert(jqXHR );
                alert("Failed");
            });

            // $.ajax({
            //     url: 'http://localhost:8080//user?type=signup&userName='+userName+'&password='+password+'&name='+name+'&moh='+moh+'&hospital='+hospital,
            //     type: "POST",
            //     dataType: "json",
            //     success: function (data, textStatus, jqXHR) {
            //         console.log(data);
            //         alert('Patient Registered successfully \n ' + data+ ' == \n' + jqXHR + ' == \n' +textStatus  );
            //         alert(JSON.stringify(data));
            //     },
            //     error: function (jqXHR, textStatus, errorThrown) {
            //         alert('Patient Registration Error : \n'+ errorThrown + ' == \n' + jqXHR + ' == \n' +textStatus );
            //         console.error(errorThrown);
            //     },
            //     // contentType: "application/json"
            // });

            // $.ajax({
            //     url: 'http://localhost:8080//user?type=signup&userName='+userName+'&password='+password+'&name='+name+'&moh='+moh+'&hospital='+hospital,
            //     type: "POST",
            //     dataType: "json",
            //     success: function (data, status, xhr) {
            //         console.log('Patient Registered successfully');
            //         alert('Patient Registered successfully');
            //     },
            //     error: function (jqXhr, textStatus, errorMessage) {
            //         console.error(errorMessage);
            //         alert('Patient Registration Error : \n'+ errorMessage + ' == \n' + jqXhr + ' == \n' +textStatus);
            //     },
            //     contentType: "application/json"
            // });


            // $.ajax({
            //     url: '127.0.0.1:8080//user?type=signup&userName=Ceena&password=12345678&name=ceena&moh=0&hospital=0',
            //     method: 'POST',
            //     data: data,
            //     success: function(d, s, e){
            //         $(".waiting-sign").removeClass("show-element");
            //         if (d.status){
            //             callback(d.status, d.msg, d.data);
            //             alert('Patient Registered successfully');
            //         }
            //         alert('Out of IF');
            //     },
            //     error: function(d, s, e){
            //         $(".waiting-sign").removeClass("show-element");
            //         callback(s, e, "");
            //         alert('Error');
            //     },
            //     contentType: "application/json"
            // });
        }
    </script>

</body>
</html>